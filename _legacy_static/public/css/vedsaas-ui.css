*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;font-family:'Segoe UI',sans-serif;background:#1e1e2f;color:#fff;overflow:hidden}
body.dark-mode{background:#0e0e12}
.container{display:flex;height:100vh;position:relative;z-index:1;overflow:hidden}
.sidebar{width:20%;min-width:275px;background:#232336;padding:18px;display:flex;flex-direction:column;gap:12px;overflow:auto}
.sidebar .title{text-align:center;font-weight:700;font-size:15px;color:#eee}
.new-topic-btn{background:#0078d4;color:#fff;border:none;padding:10px;border-radius:8px;cursor:pointer;width:100%}
.history-list{flex:1;overflow:auto;margin-top:10px;border-top:1px solid #333;padding-top:10px}
.topic{padding:8px 10px;margin-bottom:8px;border-radius:8px;cursor:pointer;color:#ddd}
.topic.active{background:#2e7bbd;color:#fff}
.topic .preview{color:#bbb;font-size:13px;margin-top:4px}
.settings-summary{margin-top:8px}
.user-chip{display:flex;align-items:center;gap:10px;background:#2f2f42;border:1px solid #4a4a60;padding:10px 12px;border-radius:10px;cursor:pointer}
.user-avatar{width:26px;height:26px;border-radius:50%;background:#0078d4;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;overflow:hidden}
.user-avatar img{width:100%;height:100%;object-fit:cover;display:block}
.user-name{font-size:13px;color:#ddd;flex:1}
.settings-panel{display:none;margin-top:8px}
.settings-panel button{display:block;width:100%;text-align:left;background:none;border:1px solid #3a3a4d;border-radius:8px;color:#ddd;padding:10px 12px;cursor:pointer;margin-bottom:6px}
.settings-panel button:hover{background:#2f2f42;color:#fff}
.main{flex:1;display:flex;flex-direction:column;min-width:0;min-height:0;overflow:hidden}
.rail{position:relative;width:100%;max-width:none;margin:0;padding-inline:16px;height:100%;display:flex;flex-direction:column;min-width:0;min-height:0}
.rail::before{content:"";background:url('/public/image/logopic.png?v=1') no-repeat center/60%;opacity:.10;position:absolute;inset:0;z-index:0;pointer-events:none}
.topbar{padding:14px 18px;border-bottom:1px solid #333;display:flex;align-items:center;justify-content:center;background:transparent;position:relative;z-index:1}
.topbar h1{margin:0;font-size:20px;letter-spacing:1px}
.top-controls{position:absolute;right:0;top:50%;transform:translateY(-50%);display:flex;gap:8px;align-items:center}
.topbar .meta{color:#bbb;font-size:14px}
.content{flex:1;min-height:0;display:flex;flex-direction:column;z-index:1;overflow:hidden}
.chat-area{flex:1;min-height:0;overflow:auto;padding:20px;display:flex;flex-direction:column;gap:12px;align-items:stretch;max-width:none;margin:0}
.message-row{max-width:80%;position:relative;line-height:1.5;display:flex;flex-direction:column}
.from-user{align-self:flex-end;text-align:right}
.from-bot{align-self:flex-start;text-align:left}
.msg-label{font-size:12px;color:#bbb;margin-bottom:4px;width:fit-content;max-width:min(720px,90%)}
.message-row .msg-body{display:block;background:transparent;color:#fff;padding:0;border-radius:0;box-shadow:none;white-space:pre-wrap;word-break:normal;overflow-wrap:break-word;max-width:72ch}
.msg-actions{position:absolute;right:-2px;bottom:-18px;display:flex;gap:6px;opacity:0;transition:opacity .15s}
.message-row:hover .msg-actions{opacity:1}
.msg-actions button{background:rgba(0,0,0,.25);border:1px solid #4a4a60;border-radius:6px;color:#fff;font-size:12px;padding:2px 6px;cursor:pointer}
.composer-wrap{position:sticky;bottom:0;z-index:2;border-top:1px solid #3a3a4d;background:transparent;padding:12px 16px;display:flex;justify-content:center}
.composer{width:100%;display:flex;align-items:flex-end;gap:10px;background:transparent;border:none;border-radius:0;padding:0}
.composer textarea{flex:1;background:transparent;color:#fff;border:none;outline:none;font-size:15px;line-height:1.4;resize:none;max-height:10rem;min-height:44px;overflow:auto}
.composer .send-btn{width:42px;height:42px;flex:0 0 42px;display:flex;align-items:center;justify-content:center;border-radius:10px;border:1px solid #4a4a60;background:#2f2f42;color:#fff;cursor:pointer}
.composer .send-btn[disabled]{opacity:.5;cursor:not-allowed}
.landing{flex:1;display:flex;align-items:center;justify-content:center}
.landing-card{background:rgba(44,44,62,0.92);border:1px solid #333;border-radius:12px;padding:22px;width:min(720px,90vw);text-align:center;position:relative;z-index:1}
.landing .title{font-size:18px;margin-bottom:6px;color:#e9e9e9}
.landing .hint{font-size:13px;color:#bdbdbd;margin-bottom:12px}
.landing .composer{margin-top:10px}
.overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:50;background:rgba(0,0,0,0.5)}
.auth-box{background:#2c2c3e;padding:28px;border-radius:12px;width:360px;box-shadow:0 6px 30px rgba(0,0,0,0.6);max-height:90vh;overflow:auto;border:1px solid #3a3a4d}
.auth-box h2{color:#fff;margin-bottom:12px;text-align:center}
.auth-box input{width:100%;padding:12px;border-radius:10px;border:1px solid #3f3f55;margin:8px 0;background:#3a3a4d;color:#fff}
.auth-box button{width:100%;padding:12px;border-radius:10px;border:none;background:#0078d4;color:#fff;cursor:pointer;margin-top:8px}
.banner{position:fixed;bottom:16px;left:50%;transform:translateX(-50%);background:#9b1c1c;color:#fff;padding:10px 14px;border-radius:8px;display:none;z-index:99}
.to-bottom{position:fixed;right:20px;bottom:84px;background:#2f2f42;border:1px solid #4a4a60;color:#fff;padding:8px 10px;border-radius:999px;display:none;align-items:center;gap:6px;cursor:pointer}
.to-bottom.show{display:flex}
.userpage{position:fixed;inset:0;z-index:60;display:none}
.userpage.show{display:flex}
.userpage .backdrop{position:absolute;inset:0;background:rgba(0,0,0,.6)}
.userpage .sheet{position:relative;z-index:1;margin:auto;background:#1e1e2f;border:1px solid #333;border-radius:16px;width:min(1000px,95vw);height:min(90vh,800px);display:flex;overflow:hidden;box-shadow:0 10px 40px rgba(0,0,0,.6)}
.userpage .aside{width:260px;background:#232336;border-right:1px solid #333;padding:16px;overflow:auto}
.userpage .aside .brand{display:flex;align-items:center;gap:10px;margin-bottom:14px}
.userpage .aside .brand .avatar{width:38px;height:38px;border-radius:50%;background:#0078d4;display:flex;align-items:center;justify-content:center;font-weight:700;overflow:hidden}
.userpage .aside .nav button{width:100%;text-align:left;background:none;border:none;color:#ddd;padding:10px 12px;border-radius:8px;cursor:pointer;margin-bottom:6px}
.userpage .aside .nav button.active,.userpage .aside .nav button:hover{background:#2f2f42;color:#fff}
.userpage .main{flex:1;padding:18px;overflow:auto}
.userpage .section-title{font-size:16px;margin-bottom:10px}
.kv{display:grid;grid-template-columns:180px 1fr;gap:10px;align-items:center;margin-bottom:10px}
.ip{width:100%;padding:10px;border-radius:10px;border:1px solid #3f3f55;background:#2c2c3e;color:#fff}
.badge{display:inline-flex;align-items:center;gap:6px;background:#2f2f42;border:1px solid #4a4a60;padding:6px 10px;border-radius:999px}
.row{display:flex;gap:10px;flex-wrap:wrap}
.card{background:#232336;border:1px solid #333;border-radius:12px;padding:12px}
.actions{display:flex;gap:10px;justify-content:flex-end;margin-top:12px}
.cta{background:#0078d4;border:none;color:#fff;padding:10px 12px;border-radius:8px;cursor:pointer}
.cta.secondary{background:#444}
.cta.danger{background:#b91c1c}
.muted{color:#bbb;font-size:12px}
@media (max-width:900px){.sidebar{display:none}.container{flex-direction:column}.kv{grid-template-columns:1fr}}
body,.chat-area,.history-list{scrollbar-width:none}
body::-webkit-scrollbar,.chat-area::-webkit-scrollbar,.history-list::-webkit-scrollbar{width:0;height:0}
